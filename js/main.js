//PRODUCTOS
const productos = [

    {
        id: "silla-gamer-01",
        titulo: "Silla Gamer 01",
        imagen: "./img/silla-gamer2.jpg",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-02",
        titulo: "Silla Gamer 02",
        imagen: "./img/silla-gamer1.jpg",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-03",
        titulo: "Silla Gamer 03",
        imagen: "./img/silla-gamer3.jpeg",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-04",
        titulo: "Silla Gamer 04",
        imagen: "./img/silla-gamer4.jpg",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-05",
        titulo: "Silla Gamer 05",
        imagen: "./img/silla-gamer5.jpg",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-06",
        titulo: "Silla Gamer 06",
        imagen: "./img/silla-gamer6.jpg",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-07",
        titulo: "Silla Gamer 07",
        imagen: "./img/silla-gamer7.png",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-08",
        titulo: "Silla Gamer 08",
        imagen: "./img/silla-gamer8.png",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-09",
        titulo: "Silla Gamer 09",
        imagen: "./img/silla-gamer9.jpg",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-10",
        titulo: "Silla Gamer 10",
        imagen: "./img/silla-gamer2.jpg",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-11",
        titulo: "Silla Gamer 11",
        imagen: "./img/silla-gamer2.jpg",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-gamer-12",
        titulo: "Silla Gamer 12",
        imagen: "./img/silla-gamer2.jpg",
        categoria: {
            nombre: "Sillas gamer",
            id: "silla-gamer",
        },
        precio: 10000,
    },    
    {
        id: "silla-oficina-01",
        titulo: "Silla Oficina 01",
        imagen: "./img/sillas-oficina1.jpg",
        categoria: {
            nombre: "Sillas de Oficina",
            id: "silla-oficina",
        },
        precio: 10000,
    },    
    {
        id: "silla-oficina-02",
        titulo: "Silla Oficina 02",
        imagen: "./img/sillas-oficina2.jpg",
        categoria: {
            nombre: "Sillas de Oficinaa",
            id: "silla-oficina",
        },
        precio: 10000,
    },    
    {
        id: "silla-oficina-03",
        titulo: "Silla Oficina 03 ",
        imagen: "./img/sillas-oficina3.jpg",
        categoria: {
            nombre: "Sillas de Oficina",
            id: "silla-oficina",
        },
        precio: 10000,
    },    
    {
        id: "silla-oficina-04",
        titulo: "Silla Oficina 04",
        imagen: "./img/sillas-oficina4.jpg",
        categoria: {
            nombre: "Sillas de Oficina",
            id: "silla-oficina",
        },
        precio: 10000,
    },    
    {
        id: "silla-oficina-05",
        titulo: "Silla Oficina 05",
        imagen: "./img/sillas-oficina4.webp",
        categoria: {
            nombre: "Sillas de Oficina",
            id: "silla-oficina",
        },
        precio: 10000,
    },    
    {
        id: "silla-oficina-06",
        titulo: "Silla Oficina 06",
        imagen: "./img/sillas-oficina6.jpg",
        categoria: {
            nombre: "Sillas de Oficinaa",
            id: "silla-oficina",
        },
        precio: 10000,
    },    
    {
        id: "silla-oficina-07",
        titulo: "Silla Oficina 07",
        imagen: "./img/sillas-oficina7.jpg",
        categoria: {
            nombre: "Sillas de Oficina",
            id: "silla-oficina",
        },
        precio: 10000,
    },    
    {
        id: "silla-oficina-08",
        titulo: "Silla Oficina 08",
        imagen: "./img/sillas-oficina9.jpg",
        categoria: {
            nombre: "Sillas de Oficina",
            id: "silla-oficina",
        },
        precio: 10000,
    },    
    {
        id: "silla-rustica-01",
        titulo: "Silla Rustica 01",
        imagen: "./img/sillas-rustica1.jpg",
        categoria: {
            nombre: "Sillas Rusticas",
            id: "silla-rustica",
        },
        precio: 10000,
    },    
    {
        id: "silla-rustica-02",
        titulo: "Silla Rustica 02",
        imagen: "./img/sillas-rustica2.jpg",
        categoria: {
            nombre: "Sillas Rusticas",
            id: "silla-rustica",
        },
        precio: 10000,
    },    
    {
        id: "silla-rustica-03",
        titulo: "Silla Rustica 03",
        imagen: "./img/sillas-rustica3.jpg",
        categoria: {
            nombre: "Sillas Rusticas",
            id: "silla-rustica",
        },
        precio: 10000,
    },    
    {
        id: "silla-rustica-04",
        titulo: "Silla Rustica 04",
        imagen: "./img/sillas-rustica4.jpg",
        categoria: {
            nombre: "Sillas Rusticas",
            id: "silla-rustica",
        },
        precio: 10000,
    },    
    {
        id: "silla-rustica-05",
        titulo: "Silla Rustica 05",
        imagen: "./img/sillas-rustica7.jpg",
        categoria: {
            nombre: "Sillas Rusticas",
            id: "silla-rustica",
        },
        precio: 10000,
    },    
    {
        id: "silla-rustica-06",
        titulo: "Silla Rustica 06",
        imagen: "./img/sillas-rustica8.jpg",
        categoria: {
            nombre: "Sillas Rusticas",
            id: "silla-rustica",
        },
        precio: 10000,
    },    
    {
        id: "silla-rustica-07",
        titulo: "Silla rustica 07",
        imagen: "./img/sillas-rustica9.jpg",
        categoria: {
            nombre: "Sillas Rusticas",
            id: "silla-rustica",
        },
        precio: 10000,
    },    
]

const botonLista = document.querySelectorAll(".boton-lista");
const tituloPrincipal = document.querySelector("#titulo-principal");
const contenedorProducto = document.querySelector("#contenedor-productos");
let botonesAgregar = document.querySelectorAll(".producto-agregar");
let numerito = document.querySelector("#numerito")

function cargarProductos (productosElegidos)  {

    contenedorProducto.innerHTML = " ";

    productosElegidos.forEach(producto => {

        const div = document.createElement("div");
        div.classList.add("contenedor-producto");
        div.innerHTML = `
        <img class="imagen-producto" src="${producto.imagen}" alt="${producto.titulo}" srcset="">
        <div class="producto-detalles" id="detalles">
            <h3 class="producto-titulo">${producto.titulo}</h3>
            <p class="producto-precio">$${producto.precio}</p>
            <button class="producto-agregar"  id= "${producto.id}">Agregar</button>
        </div>
        `;
        
        contenedorProducto.append(div);
        
    })
    actualizarBotonesAgregar();
    
    
}

cargarProductos (productos);



//Class active en los botones


botonLista.forEach(boton => {
    boton.addEventListener('click', (e) => {
        
        
        if (e.currentTarget.id != "todos") {
            const productoCategoria = productos.find(producto => producto.categoria.id === e.currentTarget.id)
            tituloPrincipal.innerText = productoCategoria.categoria.nombre;
            const productosBoton = productos.filter(producto => producto.categoria.id === e.currentTarget.id)    
            cargarProductos(productosBoton);
            
        }else {
            cargarProductos(productos);
            tituloPrincipal.innerText = "Todos los productos";
        }

        

        botonLista.forEach(boton => {
            boton.classList.remove("active")
            
        })

        e.currentTarget.classList.add("active")

    })
    
})

//DARK MODE, LIGHT MODE
const colorModeButton = document.querySelector("#color-icon");
const grilla = document.querySelector("#grilla");
const detalles = document.querySelectorAll("#detalles");
const productoAgregar = document.querySelectorAll("#agregar"); //array hecho por el querySelectorAll


colorModeButton.addEventListener("click", cambiarModoColor);

function cambiarModoColor ()  {
    grilla.classList.toggle("dark-mode");

    botonLista.forEach(boton => {
        boton.addEventListener('click', (e) => {
    
            botonLista.forEach(boton => {
                boton.classList.remove("active")
            })
    
            e.currentTarget.classList.toggle("active")
    
        })
        
    })
    
    for (let i = 0; i < botonLista.length; i++) {
        botonLista[i].classList.toggle("dark-mode")
    }
    for(let i = 0; i < detalles.length; i++) {
        detalles[i].classList.toggle("dark-mode")
    }
    for(let i = 0; i < productoAgregar.length; i++) {
        productoAgregar[i].classList.toggle("dark-mode-letter")
    }

    if(grilla.classList.contains("dark-mode")) {
        colorModeButton.classList.remove("bi-moon-fill");
        colorModeButton.classList.add("bi-brightness-high-fill");
    }else {
        colorModeButton.classList.remove("bi-brightness-high-fill");
        colorModeButton.classList.add("bi-moon-fill");
    }
}

function actualizarBotonesAgregar() {
    botonesAgregar = document.querySelectorAll(".producto-agregar");

    botonesAgregar.forEach(boton => {
        boton.addEventListener("click", agregarAlCarrito);
    });
    
}

// const productosEncarritoLS = JSON.parse(localStorage.getItem("productos-en-carrito"));
// if (productosEncarritoLS) {
//     let productosEncarrito = productosEncarritoLS
// }

let productosEnCarrito;

let productosEnCarritoLS = localStorage.getItem("productos-en-carrito")
// const productosEnCarritoLS = JSON.parse(localStorage.getItem("productos-en-carrito"));

if (productosEnCarritoLS) {
    productosEnCarrito = JSON.parse(productosEnCarritoLS);
    actualizarNumerito();
}else {
    productosEnCarrito = [];
}


function agregarAlCarrito(e) {

    const idBoton = e.target.id; 
    const productoAgregado = productos.find (producto => producto.id === idBoton);
   

    if(productosEnCarrito.some(producto => producto.id === idBoton)) {
        const index = productosEnCarrito.findIndex(producto => producto.id === idBoton);
        productosEnCarrito[index].cantidad++;
    }else {
        productoAgregado.cantidad = 1;
        productosEnCarrito.push(productoAgregado)
    }
    actualizarNumerito();

    localStorage.setItem("productos-en-carrito", JSON.stringify(productosEnCarrito))
}

function actualizarNumerito () {
    let nuevoNumerito = productosEnCarrito.reduce((acc, producto) => acc + producto.cantidad, 0);
    numerito.innerText = nuevoNumerito;
}